{% extends 'base.html' %}

{% block title %}Purchase Request Details{% endblock %}

{% block content %}
<h1>Purchase Request Details</h1>

<table>
    <tr>
        <th>Request ID</th>
        <th>Employee Name</th>
        <th>Item ID</th>
        <th>Unit of Measurement</th>
        <th>Quantity</th>
        <th>Price Without VAT</th>
        <th>Comment</th>
        <th>Status</th>
    </tr>
    <tr>
        <td>{{ request_info['RequestID'] }}</td>
        <td>{{ request_info['EmployeeName'] }}</td>
        <td>{{ request_info['ItemID'] }}</td>
        <td>{{ request_info['UnitOfMeasurement'] }}</td>
        <td>
            <form method="post" action="{{ url_for('routes.requests.update_quantity', request_id=request_info['RequestID']) }}">
                <input type="hidden" name="request_id" value="{{ request_info['RequestID'] }}">
                <input type="number" name="quantity" value="{{ request_info['Quantity'] }}" min="1">
                <button type="submit">Update Quantity</button>
            </form>            
        </td>
        <td>{{ request_info['PriceWithoutVAT'] }}</td>
        <td>{{ request_info['Comment'] }}</td>
        <td>{{ request_info['Status'] }}</td>
    </tr>
</table>

<h2>Items in Request</h2>
{% if items %}
<table>
    <tr>
        <th>Item ID</th>
        <th>Unit of Measurement</th>
        <th>Quantity</th>
        <th>Price Without VAT</th>
        <th>Comment</th>
    </tr>
    {% for item in items %}
    <tr>
        <td>{{ item['ItemID'] }}</td>
        <td>{{ item['UnitOfMeasurement'] }}</td>
        <td>{{ item['Quantity'] }}</td>
        <td>{{ item['PriceWithoutVAT'] }}</td>
        <td>{{ item['Comment'] }}</td>
    </tr>
    {% endfor %}
</table>

<form method="post" action="{{ url_for('routes.requests.confirm_purchase_request', request_id=request_info['RequestID']) }}">
    <button type="submit">Confirm Request</button>
</form>

<form method="post" action="{{ url_for('routes.requests.reject_purchase_request', request_id=request_info['RequestID']) }}">
    <label for="reject-comment">Reject Request with Comment:</label>
    <input type="text" id="reject-comment" name="comment">
    <button type="submit">Reject Request</button>
</form>
{% else %}
<p>No items in this request.</p>
{% endif %}
{% endblock %}
